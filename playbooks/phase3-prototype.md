# Phase 3: Prototype プレイブック

> 設計をもとに、UI設計を確定させ、動作するプロトタイプを高速構築し、フィードバックを得る
>
> **方針**: UI（画面レイアウト・遷移導線・表示要素）はこのフェーズで確定する。UX（体験の洗練）は Construction 以降で扱う。

## 前提条件

- Phase 2 が完了していること（aidlc-docs/aidlc-state.md で確認）
- `aidlc-docs/` 配下の全成果物が存在すること

## フェーズ開始時の成果物読み込み

Phase 3 の各ステップに入る前に、以下の成果物を一括で読み込む:

- `aidlc-docs/inception/intent.md`
- `aidlc-docs/inception/requirements.md`
- `aidlc-docs/inception/user-stories.md`
- `aidlc-docs/blueprint/ui-design.md`

---

## Step 1: Prototype Design（プロトタイプ設計）

### AIの行動

1. **Blueprint の成果物を読み込む**
   - ui-design.md を読み込む
   - プロトタイプに必要な最小限の要素を特定する

2. **プロトタイプのゴールを定義する**
   - このプロトタイプで検証したいことを明確にする
   - 人間に確認: 「プロトタイプで特に確認したいことはありますか？」

3. **最小限のエンティティを定義する**
   - user-stories.md と ui-design.md から、プロトタイプに必要なエンティティを洗い出す
   - 属性は必要最小限に絞る（プロダクション用のデータモデル設計は Phase 4 で行う）

4. **主要ユースケースを定義する**
   - ui-design.md から、プロトタイプで再現する3〜5個の主要フローを選ぶ
   - ステップを簡潔に記述する

5. **UI設計を確定する（ラフ → 実装レベルへ詳細化）**
   - Phase 2 の ui-design.md（ラフレベル: 画面一覧・遷移フロー・各画面の概要）を読み込む
   - ラフ設計をベースに、実装レベルの詳細を追加する:
     - 各画面の具体的なレイアウト（ASCII ワイヤーフレーム）を作成する
     - 構成要素（コンポーネント）とその配置を決める
     - 各画面の表示データ（何をどう表示するか）を定義する
     - インタラクション（ボタン押下時の挙動、入力の振る舞い等）を記述する
   - 画面遷移フロー（導線）を Mermaid で図示し、必要に応じて Phase 2 の遷移フローを更新する
   - 人間に確認: 「この画面構成と遷移で進めてよいですか？」
   - ※ UX（マイクロインタラクション、アニメーション、ローディング表現等）はこの段階では対象外

6. **モックデータを作成する**
   - 画面表示に使うサンプルデータをJSON形式で作成する
   - リアルに見える具体的なデータにする

7. **プロトタイプ用の技術スタックを決定する**
   - プロトタイプに適した技術スタックを提案する（速度優先で選定）
   - 人間に確認: 「この技術スタックでプロトタイプを作りますか？」
   - ※ プロダクション用のアーキテクチャ設計は Phase 4 で行う。プロトタイプの技術選定とは独立

8. **対象外を明記する**
   - プロトタイプでは作らないものを明確にする（認証、エラーハンドリング等）

### 成果物の生成

- `aidlc-docs/prototype/design.md` を生成する
- テンプレート: `templates/prototype/design.md` を使用

### 記録

- `aidlc-docs/log.md` に対話サマリーを記録する

### 完了条件

- `aidlc-docs/prototype/design.md` が生成され、人間が確認した
- `aidlc-docs/aidlc-state.md` の Step 1 チェックボックスを `[x]` にする

---

## Step 2: Rapid Build（高速構築）

### AIの行動

1. **aidlc-docs/prototype/design.md を読み込む**
   - エンティティ、ユースケース、モックデータ、技術スタックを把握する

2. **プロジェクトを生成する**
   - 選定した技術スタックでプロジェクトをセットアップする
   - モックデータを組み込む
   - 主要画面を実装する

3. **UI設計どおりに画面を実装する**
   - design.md の画面一覧・レイアウト・コンポーネント構成に従って実装する
   - 画面遷移（ルーティング・ナビゲーション）を設計どおりに実装する
   - 各画面の表示要素（テーブル、リスト、フォーム、ボタン等）を配置する
   - レスポンシブ対応は不要。主要な画面サイズ1つで十分

4. **ラピッドプロトタイピングの原則に従う**
   - 速度を最優先。コード品質は二の次
   - コピペOK、ハードコードOK
   - 静的データ / useState で十分
   - 型安全性不要
   - テスト不要
   - エラーハンドリング最小限
   - **ただし UI の構成・導線・表示要素は design.md に忠実に実装する**

5. **動作確認する**
   - プロトタイプが起動するか確認する
   - 主要フローが動作するか確認する
   - 画面遷移が設計どおりに機能するか確認する
   - 問題があればその場で修正する

### 成果物の生成

- `aidlc-docs/prototype/` 配下に動作するコードを生成する

### 記録

- `aidlc-docs/log.md` に対話サマリーを記録する
- 何を作ったか、動作確認の結果を記録する

### 完了条件

- プロトタイプが動作する状態になった
- `aidlc-docs/aidlc-state.md` の Step 2 チェックボックスを `[x]` にする

---

## Step 3: Review & Feedback（レビュー・フィードバック）

### AIの行動

1. **プロトタイプを人間に提示する**
   - プロトタイプの起動方法を伝える
   - 「プロトタイプを触ってみてください。フィードバックをお聞かせください」と伝える

2. **フィードバックを受け取る**
   - 人間のフィードバックを聞き、分類する

3. **フィードバックに基づき次のアクションを決定する**

   | フィードバック内容 | アクション |
   |-------------------|-----------|
   | そもそも方向性が違う | Phase 1 (Inception) に戻る。intent.md を修正 |
   | 設計を変えたい | Phase 2 (Blueprint) に戻る。該当する設計を修正 |
   | 画面構成・導線を変えたい | Step 1 に戻り、UI設計を修正してから再ビルド |
   | 画面の見た目・表示を調整したい | Step 2 に戻り、プロトタイプを修正して再ビルド |
   | これでOK | Phase 4 (Construction) に進む。UI設計は確定とする |

4. **戻る場合のルール**
   - `aidlc-docs/log.md` にフィードバックの理由と戻り先を記録する
   - `aidlc-docs/aidlc-state.md` の `Current Phase` を戻り先に更新する
   - 戻り先のフェーズのチェックボックスは、修正が必要なステップのみ `[ ]` に戻す
   - 修正完了後、再度このステップに戻ってくる

### 記録

- `aidlc-docs/log.md` にフィードバック内容と決定事項を記録する

### 完了条件（承認 → 次に進む場合）

- 人間がプロトタイプを承認した
- UI設計（画面構成・遷移導線・表示要素）が確定した
- `aidlc-docs/aidlc-state.md` の Step 3 チェックボックスを `[x]` にする
- `aidlc-docs/aidlc-state.md` の `Current Phase` を `Phase 4 - Construction` に更新する
